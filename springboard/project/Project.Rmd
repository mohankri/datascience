---
title: "Movie Modeling"
output: html_document
---
## Overview
As proposed in initial project submission, this project intends to perform study on the movie industry trends and model  
prediction for the future trends.

### Number of Movies/Year

```{r echo=FALSE, message=FALSE}
library(dplyr)
library(ggplot2)
DIR<-paste(Sys.getenv("HOME"), "/datascience/springboard/project/", sep="")
setwd(DIR)
df<- read.table(paste(DIR, "MergeDataSet.csv", sep=""), sep=",", header=TRUE)
ldf <- tbl_df(df)
```

```{r echo=FALSE, message=FALSE}
yrsum<-ldf %>% group_by(Year) %>% summarise(n())
p<-ggplot(yrsum, aes(x=Year, y=`n()`)) + geom_bar(stat="identity", width = 1, fill="steelblue") + theme_minimal()
print(p)
```
### Model Linear Regression 

```{r}
#train_data <- subset(ldf, Year > 1975)
train_data <- ldf
yrsum<-train_data %>% group_by(Year) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)
p<-ggplot(yrsum, aes(x=Year, y=`n()`)) + geom_point() +  
  geom_hline(yintercept=mean.num_of_movie) + 
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")

print(p)
```

## 

# Movies Genre

```{r echo=FALSE, message=FALSE}
category<-ldf %>% group_by(Genre) %>% summarise(n())

p<-ggplot(category, aes(x=Genre, y=`n()`)) + geom_bar(stat="identity", width = 1, fill="steelblue") +   
      theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
print(p)
```

##  Genre = "Drama"" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Drama")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```

##  Genre = "Action" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Action")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```

##  Genre = "Adventure" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Adventure")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```


##  Genre = "Comedy" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Comedy")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```

##  Genre = "Horror" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Horror")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```

##  Genre = "Western" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Western")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```


##  Genre = "Thriller/Suspense" Linear Regression

```{r}
train_data <- ldf
train_data <- train_data %>% filter(train_data$Genre == "Thriller/Suspense")
yrsum<-train_data %>% group_by(Year, Genre) %>% summarise(n())
mean.num_of_movie=mean(yrsum$`n()`, na.rm=T)
model1 <- lm(yrsum$`n()`~Year, data=yrsum)

p<-ggplot(yrsum, aes(x=Year, y=yrsum$`n()`)) + geom_point() +
  geom_hline(yintercept=mean.num_of_movie) +
  geom_abline(intercept=model1$coefficients[1], slope=model1$coefficients[2], color="red")
print(p)
```
